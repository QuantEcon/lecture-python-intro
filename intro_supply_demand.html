
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>7. Introduction to Supply and Demand &#8212; A First Course in Quantitative Economics with Python</title>
    <script src="https://unpkg.com/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
    <script src="https://unpkg.com/tippy.js@6.3.1/dist/tippy-bundle.umd.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
    
        <script>
            MathJax = {
            loader: {load: ['[tex]/boldsymbol', '[tex]/textmacros']},
            tex: {
                packages: {'[+]': ['boldsymbol', 'textmacros']},
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                processEscapes: true,
                macros: {
                    "argmax" : "arg\\,max",
                    "argmin" : "arg\\,min",
                    "col"    : "col",
                    "Span"   :  "span",
                    "epsilon": "\\varepsilon",
                    "EE": "\\mathbb{E}",
                    "PP": "\\mathbb{P}",
                    "RR": "\\mathbb{R}",
                    "NN": "\\mathbb{N}",
                    "ZZ": "\\mathbb{Z}",
                    "aA": "\\mathcal{A}",
                    "bB": "\\mathcal{B}",
                    "cC": "\\mathcal{C}",
                    "dD": "\\mathcal{D}",
                    "eE": "\\mathcal{E}",
                    "fF": "\\mathcal{F}",
                    "gG": "\\mathcal{G}",
                    "hH": "\\mathcal{H}",
                }
            },
            svg: {
                fontCache: 'global',
                scale: 0.92,
                displayAlign: "center",
            },
            };
        </script>
    
    
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" href="_static/styles/quantecon-book-theme.css?digest=bd0785fbb14d8d2bd4d9ae501d79ed8d3bc089ec" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css?v=6644e6bb" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/exercise.css?v=982b99e0" />
    <link rel="stylesheet" type="text/css" href="_static/proof.css?v=4c010e0d" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>


    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script src="_static/scripts/quantecon-book-theme.js?digest=d9faaf6c4b57726f74ba012412af1f5681bdff87"></script>
    <script src="_static/scripts/jquery.js?v=5d32c60e"></script>
    <script src="_static/scripts/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-QDS1YRJNGM"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-QDS1YRJNGM');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-QDS1YRJNGM');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"tex": {"macros": {"argmax": "arg\\,max", "argmin": "arg\\,min"}}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'intro_supply_demand';</script>
    <link rel="canonical" href="https://intro.quantecon.org/intro_supply_demand.html" />
    <link rel="icon" href="_static/lectures-favicon.ico"/>
    <link rel="author" title="About these documents" href="about.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="8. Linear Equations and Matrix Algebra" href="linear_equations.html" />
    <link rel="prev" title="6. Income and Wealth Inequality" href="inequality.html" />

<!-- Normal Meta Tags -->
<meta name="author" context="Thomas J. Sargent &amp; John Stachurski" />
<meta name="keywords" content="Python, QuantEcon, Quantitative Economics, Economics, Sloan, Alfred P. Sloan Foundation, Tom J. Sargent, John Stachurski" />
<meta name="description" content=This website presents introductory lectures on computational economics, designed and written by Thomas J. Sargent and John Stachurski. />

<!-- Twitter tags -->
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@quantecon" />
<meta name="twitter:title" content="Introduction to Supply and Demand"/>
<meta name="twitter:description" content="This website presents introductory lectures on computational economics, designed and written by Thomas J. Sargent and John Stachurski.">
<meta name="twitter:creator" content="@quantecon">
<meta name="twitter:image" content="https://assets.quantecon.org/img/qe-twitter-logo.png">

<!-- Opengraph tags -->
<meta property="og:title" content="Introduction to Supply and Demand" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://intro.quantecon.org/intro_supply_demand.html" />
<meta property="og:image" content="https://assets.quantecon.org/img/qe-og-logo.png" />
<meta property="og:description" content="This website presents introductory lectures on computational economics, designed and written by Thomas J. Sargent and John Stachurski." />
<meta property="og:site_name" content="A First Course in Quantitative Economics with Python" />
<meta name="theme-color" content="#ffffff" />

  </head>
<body>

<!-- Override QuantEcon theme colors -->

    <span id="top"></span>

    <div class="qe-wrapper">

        <div class="qe-main">

            <div class="qe-page" id=intro_supply_demand>

                <div class="qe-page__toc">

                    <div class="inner">

                        
                        <div class="qe-page__toc-header">
                            On this page
                        </div>


                        <nav id="bd-toc-nav" class="qe-page__toc-nav">
                            <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">7.1. Overview</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#why-does-this-model-matter">7.1.1. Why does this model matter?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#topics-and-infrastructure">7.1.2. Topics and infrastructure</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#consumer-surplus">7.2. Consumer surplus</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-discrete-example">7.2.1. A discrete example</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-comment-on-quantity">7.2.2. A comment on quantity.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-continuous-approximation">7.2.3. A continuous approximation</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#producer-surplus">7.3. Producer surplus</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-discrete-case">7.3.1. The discrete case</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#integration">7.4. Integration</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#supply-and-demand">7.5. Supply and demand</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">7.5.1. Consumer surplus</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">7.5.2. Producer surplus</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#social-welfare">7.5.3. Social welfare</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#competitive-equilibrium">7.5.4. Competitive equilibrium</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#generalizations">7.6. Generalizations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">7.7. Exercises</a></li>
</ul>
                            <p class="logo">
                                
                                    
                                    <a href=https://quantecon.org><img src="_static/qe-logo.png" class="logo logo-img" alt="logo"></a>
                                    
                                    <a href=https://quantecon.org><img src="_static/quantecon-logo-transparent.png" class="dark-logo-img" alt="logo"></a>
                                    
                                    
                                
                            </p>

                            <p class="powered">Powered by <a href="https://jupyterbook.org/">Jupyter Book</a></p>

                        </nav>

                        <div class="qe-page__toc-footer">
                            
                            
                            <p><a href="#top"><strong>Back to top</strong></a></p>
                        </div>

                    </div>

                </div>

                <div class="qe-page__header">

                    <div class="qe-page__header-copy">

                        <p class="qe-page__header-heading"><a href="intro.html">A First Course in Quantitative Economics with Python</a></p>

                        <p class="qe-page__header-subheading">Introduction to Supply and Demand</p>

                    </div>
                    <!-- length 2, since its a string and empty dict has length 2 - {} -->
                        <p class="qe-page__header-authors" font-size="18">
                            
                                
                                    <a href="http://www.tomsargent.com/" target="_blank"><span>Thomas J. Sargent</span></a>
                                
                            
                                
                                    and <a href="https://johnstachurski.net/" target="_blank"><span>John Stachurski</span></a>
                                
                            
                        </p>


                </div> <!-- .page__header -->



                
                <main class="qe-page__content" role="main">
                    
                    <div>
                        
  <section class="tex2jax_ignore mathjax_ignore" id="introduction-to-supply-and-demand">
<h1><span class="section-number">7. </span>Introduction to Supply and Demand<a class="headerlink" href="#introduction-to-supply-and-demand" title="Link to this heading">#</a></h1>
<section id="overview">
<h2><span class="section-number">7.1. </span>Overview<a class="headerlink" href="#overview" title="Link to this heading">#</a></h2>
<p>This lecture is about some models of equilibrium prices and quantities, one of
the core topics of elementary microeconomics.</p>
<p>Throughout the lecture, we focus on models with one good and one price.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>In a <a class="reference internal" href="supply_demand_multiple_goods.html"><span class="doc">subsequent lecture</span></a> we will investigate settings with
many goods.</p>
</div>
<section id="why-does-this-model-matter">
<h3><span class="section-number">7.1.1. </span>Why does this model matter?<a class="headerlink" href="#why-does-this-model-matter" title="Link to this heading">#</a></h3>
<p>In the 15th, 16th, 17th and 18th centuries, mercantilist ideas held sway among most rulers of European countries.</p>
<p>Exports were regarded as good because they brought in bullion (gold flowed into the country).</p>
<p>Imports were regarded as bad because bullion was required to pay for them (gold flowed out).</p>
<p>This <a class="reference external" href="https://en.wikipedia.org/wiki/Zero-sum_game">zero-sum</a> view of economics was eventually overturned by the work of the classical economists such as <a class="reference external" href="https://en.wikipedia.org/wiki/Adam_Smith">Adam Smith</a> and <a class="reference external" href="https://en.wikipedia.org/wiki/David_Ricardo">David Ricardo</a>, who showed how freeing domestic and international trade can enhance welfare.</p>
<p>There are many different expressions of this idea in economics.</p>
<p>This lecture discusses one of the simplest: how free adjustment of prices can maximize a measure of social welfare in the market for a single good.</p>
</section>
<section id="topics-and-infrastructure">
<h3><span class="section-number">7.1.2. </span>Topics and infrastructure<a class="headerlink" href="#topics-and-infrastructure" title="Link to this heading">#</a></h3>
<p>Key infrastructure concepts that we will encounter in this lecture are:</p>
<ul class="simple">
<li><p>inverse demand curves</p></li>
<li><p>inverse supply curves</p></li>
<li><p>consumer surplus</p></li>
<li><p>producer surplus</p></li>
<li><p>integration</p></li>
<li><p>social welfare as the sum of consumer and producer surpluses</p></li>
<li><p>the relationship between  equilibrium quantity and social welfare optimum</p></li>
</ul>
<p>In our exposition we will use the following Python imports.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">collections</span><span class="w"> </span><span class="kn">import</span> <span class="n">namedtuple</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="consumer-surplus">
<h2><span class="section-number">7.2. </span>Consumer surplus<a class="headerlink" href="#consumer-surplus" title="Link to this heading">#</a></h2>
<p>Before we look at the model of supply and demand, it will be helpful to have some background on (a) consumer and producer surpluses and (b) integration.</p>
<p>(If you are comfortable with both topics you can jump to the <a class="reference internal" href="#integration"><span class="std std-ref">next section</span></a>.)</p>
<section id="a-discrete-example">
<h3><span class="section-number">7.2.1. </span>A discrete example<a class="headerlink" href="#a-discrete-example" title="Link to this heading">#</a></h3>
<div class="proof example admonition" id="isd_ex_cs">
<p class="admonition-title"><span class="caption-number">Example 7.1 </span></p>
<section class="example-content" id="proof-content">
<p>Regarding consumer surplus, suppose that we have a single good and 10 consumers.</p>
<p>These 10 consumers have different preferences; in particular, the amount they would be willing to pay for one unit of the good differs.</p>
<p>Suppose that the willingness to pay for each of the 10 consumers is as follows:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>consumer</p></th>
<th class="head"><p>1</p></th>
<th class="head"><p>2</p></th>
<th class="head"><p>3</p></th>
<th class="head"><p>4</p></th>
<th class="head"><p>5</p></th>
<th class="head"><p>6</p></th>
<th class="head"><p>7</p></th>
<th class="head"><p>8</p></th>
<th class="head"><p>9</p></th>
<th class="head"><p>10</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>willing to pay</p></td>
<td><p>98</p></td>
<td><p>72</p></td>
<td><p>41</p></td>
<td><p>38</p></td>
<td><p>29</p></td>
<td><p>21</p></td>
<td><p>17</p></td>
<td><p>12</p></td>
<td><p>11</p></td>
<td><p>10</p></td>
</tr>
</tbody>
</table>
</div>
<p>(We have ordered consumers by willingness to pay, in descending order.)</p>
</section>
</div><p>If <span class="math notranslate nohighlight">\(p\)</span> is the price of the good and  <span class="math notranslate nohighlight">\(w_i\)</span> is the amount that consumer <span class="math notranslate nohighlight">\(i\)</span> is willing to pay, then <span class="math notranslate nohighlight">\(i\)</span> buys when <span class="math notranslate nohighlight">\(w_i \geq p\)</span>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If <span class="math notranslate nohighlight">\(p=w_i\)</span> the consumer is indifferent between buying and not buying; we arbitrarily assume that they buy.</p>
</div>
<p>The <strong>consumer surplus</strong> of the <span class="math notranslate nohighlight">\(i\)</span>-th consumer is <span class="math notranslate nohighlight">\(\max\{w_i - p, 0\}\)</span></p>
<ul class="simple">
<li><p>if <span class="math notranslate nohighlight">\(w_i \geq p\)</span>, then the consumer buys and gets surplus <span class="math notranslate nohighlight">\(w_i - p\)</span></p></li>
<li><p>if <span class="math notranslate nohighlight">\(w_i &lt; p\)</span>, then the consumer does not buy and gets surplus <span class="math notranslate nohighlight">\(0\)</span></p></li>
</ul>
<p>For example, if the price is <span class="math notranslate nohighlight">\(p=40\)</span>, then consumer 1 gets surplus <span class="math notranslate nohighlight">\(98-40=58\)</span>.</p>
<p>The bar graph below shows the surplus of each consumer when <span class="math notranslate nohighlight">\(p=25\)</span>.</p>
<p>The total height of each bar <span class="math notranslate nohighlight">\(i\)</span> is willingness to pay by consumer <span class="math notranslate nohighlight">\(i\)</span>.</p>
<p>The orange portion of some of the bars shows consumer surplus.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">consumers</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span> <span class="c1"># consumers 1,..., 10</span>
<span class="c1"># willingness to pay for each consumer</span>
<span class="n">wtp</span> <span class="o">=</span> <span class="p">(</span><span class="mi">98</span><span class="p">,</span> <span class="mi">72</span><span class="p">,</span> <span class="mi">41</span><span class="p">,</span> <span class="mi">38</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">price</span> <span class="o">=</span> <span class="mi">25</span>
<span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">consumers</span><span class="p">,</span> <span class="n">wtp</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;consumer surplus&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;darkorange&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span> <span class="p">(</span><span class="n">price</span><span class="p">,</span> <span class="n">price</span><span class="p">),</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;price $p$&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">consumers</span><span class="p">,</span> <span class="p">[</span><span class="nb">min</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">price</span><span class="p">)</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">wtp</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">consumers</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;willingness to pay, price&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;consumer, quantity&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<figure class="align-default" id="wpdisc">
<a class="reference internal image-reference" href="_images/3573e08bed67c97285ae9a1bc9fb9d5db5e39191a05614540a2520f2aecff8ff.png"><img alt="_images/3573e08bed67c97285ae9a1bc9fb9d5db5e39191a05614540a2520f2aecff8ff.png" src="_images/3573e08bed67c97285ae9a1bc9fb9d5db5e39191a05614540a2520f2aecff8ff.png" style="width: 80%;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 7.1 </span><span class="caption-text">Willingness to pay (discrete)</span><a class="headerlink" href="#wpdisc" title="Link to this image">#</a></p>
</figcaption>
</figure>
</div>
</div>
<p>The total consumer surplus in this market is</p>
<div class="math notranslate nohighlight">
\[ 
\sum_{i=1}^{10} \max\{w_i - p, 0\}
= \sum_{w_i \geq p} (w_i - p)
\]</div>
<p>Since consumer surplus <span class="math notranslate nohighlight">\(\max\{w_i-p,0\}\)</span> of consumer <span class="math notranslate nohighlight">\(i\)</span> is a measure of her gains from trade (i.e., extent to which the good is valued over and above the amount the consumer had to pay), it is reasonable to consider total consumer surplus as a measurement of consumer welfare.</p>
<p>Later we will pursue this idea further, considering how different prices lead to different welfare outcomes for consumers and producers.</p>
</section>
<section id="a-comment-on-quantity">
<h3><span class="section-number">7.2.2. </span>A comment on quantity.<a class="headerlink" href="#a-comment-on-quantity" title="Link to this heading">#</a></h3>
<p>Notice that in the figure, the horizontal axis is labeled “consumer, quantity”.</p>
<p>We have added “quantity” here because we can read the number of units sold from this axis, assuming for now that there are sellers who are willing to sell as many units as the consumers demand, given the current market price <span class="math notranslate nohighlight">\(p\)</span>.</p>
<p>In this example, consumers 1 to 5 buy, and the quantity sold is 5.</p>
<p>Below we drop the assumption that sellers will provide any amount at a given price and study how this changes outcomes.</p>
</section>
<section id="a-continuous-approximation">
<h3><span class="section-number">7.2.3. </span>A continuous approximation<a class="headerlink" href="#a-continuous-approximation" title="Link to this heading">#</a></h3>
<p>It is often convenient to assume that there is a “very large number” of consumers, so that willingness to pay becomes a continuous curve.</p>
<p>As before, the vertical axis measures willingness to pay, while the horizontal axis measures quantity.</p>
<p>This kind of curve is called an <strong>inverse demand curve</strong></p>
<p>An example is provided below, showing both an inverse demand curve and a set price.</p>
<p>The inverse demand curve is given by</p>
<div class="math notranslate nohighlight">
\[
p = 100 e^{-q} 
\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">inverse_demand</span><span class="p">(</span><span class="n">q</span><span class="p">):</span>
    <span class="k">return</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span> <span class="n">q</span><span class="p">)</span>

<span class="c1"># build a grid to evaluate the function at different values of q</span>
<span class="n">q_min</span><span class="p">,</span> <span class="n">q_max</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span>
<span class="n">q_grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">q_min</span><span class="p">,</span> <span class="n">q_max</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>

<span class="c1"># plot the inverse demand curve</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">((</span><span class="n">q_min</span><span class="p">,</span> <span class="n">q_max</span><span class="p">),</span> <span class="p">(</span><span class="n">price</span><span class="p">,</span> <span class="n">price</span><span class="p">),</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;price&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">q_grid</span><span class="p">,</span> <span class="n">inverse_demand</span><span class="p">(</span><span class="n">q_grid</span><span class="p">),</span> 
        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;orange&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;inverse demand curve&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;willingness to pay, price&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;quantity&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">q_min</span><span class="p">,</span> <span class="n">q_max</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">110</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<figure class="align-default" id="wpcont">
<a class="reference internal image-reference" href="_images/252f15abd7f324d6d98cb4d44c03a03ba033b47cc7f170df5d083b57980d3a01.png"><img alt="_images/252f15abd7f324d6d98cb4d44c03a03ba033b47cc7f170df5d083b57980d3a01.png" src="_images/252f15abd7f324d6d98cb4d44c03a03ba033b47cc7f170df5d083b57980d3a01.png" style="width: 80%;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 7.2 </span><span class="caption-text">Willingness to pay (continuous)</span><a class="headerlink" href="#wpcont" title="Link to this image">#</a></p>
</figcaption>
</figure>
</div>
</div>
<p>Reasoning by analogy with the discrete case, the area under the demand curve and above the price is called the <strong>consumer surplus</strong>, and is a measure of total gains from trade on the part of consumers.</p>
<p>The consumer surplus is shaded in the figure below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># solve for the value of q where demand meets price</span>
<span class="n">q_star</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">price</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">((</span><span class="n">q_min</span><span class="p">,</span> <span class="n">q_max</span><span class="p">),</span> <span class="p">(</span><span class="n">price</span><span class="p">,</span> <span class="n">price</span><span class="p">),</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;price&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">q_grid</span><span class="p">,</span> <span class="n">inverse_demand</span><span class="p">(</span><span class="n">q_grid</span><span class="p">),</span> 
        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;orange&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;inverse demand curve&quot;</span><span class="p">)</span>
<span class="n">small_grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">q_star</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">small_grid</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">small_grid</span><span class="p">),</span> <span class="n">price</span><span class="p">),</span>
                <span class="n">inverse_demand</span><span class="p">(</span><span class="n">small_grid</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;orange&quot;</span><span class="p">,</span>
                <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;consumer surplus&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">q_star</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">price</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;willingness to pay, price&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;quantity&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">q_min</span><span class="p">,</span> <span class="n">q_max</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">110</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">q_star</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;$q^*$&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<figure class="align-default" id="wpcont-cs">
<a class="reference internal image-reference" href="_images/99d5f7d8eb1e8f11a59f70277eda708e0fb2a8d3ca1dd5f03abfd1a6af7f245e.png"><img alt="_images/99d5f7d8eb1e8f11a59f70277eda708e0fb2a8d3ca1dd5f03abfd1a6af7f245e.png" src="_images/99d5f7d8eb1e8f11a59f70277eda708e0fb2a8d3ca1dd5f03abfd1a6af7f245e.png" style="width: 80%;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 7.3 </span><span class="caption-text">Willingness to pay (continuous) with consumer surplus</span><a class="headerlink" href="#wpcont-cs" title="Link to this image">#</a></p>
</figcaption>
</figure>
</div>
</div>
<p>The value <span class="math notranslate nohighlight">\(q^*\)</span> is where the inverse demand curve meets price.</p>
</section>
</section>
<section id="producer-surplus">
<h2><span class="section-number">7.3. </span>Producer surplus<a class="headerlink" href="#producer-surplus" title="Link to this heading">#</a></h2>
<p>Having discussed demand, let’s now switch over to the supply side of the market.</p>
<section id="the-discrete-case">
<h3><span class="section-number">7.3.1. </span>The discrete case<a class="headerlink" href="#the-discrete-case" title="Link to this heading">#</a></h3>
<p>The figure below shows the price at which a collection of producers, also numbered 1 to 10, are willing to sell one unit of the good in question</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">producers</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span> <span class="c1"># producers 1,..., 10</span>
<span class="c1"># willingness to sell for each producer</span>
<span class="n">wts</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">39</span><span class="p">,</span> <span class="mi">46</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">88</span><span class="p">,</span> <span class="mi">91</span><span class="p">)</span>
<span class="n">price</span> <span class="o">=</span> <span class="mi">25</span>
<span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">producers</span><span class="p">,</span> <span class="n">wts</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;willingness to sell&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">producers</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;willingness to sell&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;producer&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<figure class="align-default" id="wsdisc">
<a class="reference internal image-reference" href="_images/4faf8e78d3b68c1615144c63a64850455fab4b4fe1f1e26c0abdf24089e1a441.png"><img alt="_images/4faf8e78d3b68c1615144c63a64850455fab4b4fe1f1e26c0abdf24089e1a441.png" src="_images/4faf8e78d3b68c1615144c63a64850455fab4b4fe1f1e26c0abdf24089e1a441.png" style="width: 80%;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 7.4 </span><span class="caption-text">Willingness to sell (discrete)</span><a class="headerlink" href="#wsdisc" title="Link to this image">#</a></p>
</figcaption>
</figure>
</div>
</div>
<p>Let <span class="math notranslate nohighlight">\(v_i\)</span> be the price at which producer <span class="math notranslate nohighlight">\(i\)</span> is willing to sell the good.</p>
<p>When the price is <span class="math notranslate nohighlight">\(p\)</span>, producer surplus for producer <span class="math notranslate nohighlight">\(i\)</span> is <span class="math notranslate nohighlight">\(\max\{p - v_i, 0\}\)</span>.</p>
<div class="proof example admonition" id="isd_ex_dc">
<p class="admonition-title"><span class="caption-number">Example 7.2 </span></p>
<section class="example-content" id="proof-content">
<p>For example, a producer willing to sell at $10 and selling at price $20 makes a surplus of $10.</p>
<p>Total producer surplus is given by</p>
<div class="math notranslate nohighlight">
\[
\sum_{i=1}^{10} \max\{p - v_i, 0\}
= \sum_{p \geq v_i} (p - v_i)
\]</div>
<p>As for the consumer case, it can be helpful for analysis if we approximate producer willingness to sell into a continuous curve.</p>
<p>This curve is called the <strong>inverse supply curve</strong></p>
<p>We show an example below where the inverse supply curve is</p>
<div class="math notranslate nohighlight">
\[
p = 2 q^2
\]</div>
<p>The shaded area is the total producer surplus in this continuous model.</p>
</section>
</div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">inverse_supply</span><span class="p">(</span><span class="n">q</span><span class="p">):</span>
    <span class="k">return</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">q</span><span class="o">**</span><span class="mi">2</span>

<span class="c1"># solve for the value of q where supply meets price</span>
<span class="n">q_star</span> <span class="o">=</span> <span class="p">(</span><span class="n">price</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># plot the inverse supply curve</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">((</span><span class="n">q_min</span><span class="p">,</span> <span class="n">q_max</span><span class="p">),</span> <span class="p">(</span><span class="n">price</span><span class="p">,</span> <span class="n">price</span><span class="p">),</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;price&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">q_grid</span><span class="p">,</span> <span class="n">inverse_supply</span><span class="p">(</span><span class="n">q_grid</span><span class="p">),</span> 
        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;inverse supply curve&quot;</span><span class="p">)</span>
<span class="n">small_grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">q_star</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">small_grid</span><span class="p">,</span> <span class="n">inverse_supply</span><span class="p">(</span><span class="n">small_grid</span><span class="p">),</span> 
                <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">small_grid</span><span class="p">),</span> <span class="n">price</span><span class="p">),</span> 
                <span class="n">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">,</span>
                <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;producer surplus&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">q_star</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">price</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;willingness to sell, price&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;quantity&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">q_min</span><span class="p">,</span> <span class="n">q_max</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">60</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">q_star</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;$q^*$&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<figure class="align-default" id="wscont">
<a class="reference internal image-reference" href="_images/8be965835908a10df07e02d2bd1efe19d72d322e826d553b9f4abdca7d924b27.png"><img alt="_images/8be965835908a10df07e02d2bd1efe19d72d322e826d553b9f4abdca7d924b27.png" src="_images/8be965835908a10df07e02d2bd1efe19d72d322e826d553b9f4abdca7d924b27.png" style="width: 80%;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 7.5 </span><span class="caption-text">Willingness to sell (continuous) with producer surplus</span><a class="headerlink" href="#wscont" title="Link to this image">#</a></p>
</figcaption>
</figure>
</div>
</div>
</section>
</section>
<section id="integration">
<span id="id1"></span><h2><span class="section-number">7.4. </span>Integration<a class="headerlink" href="#integration" title="Link to this heading">#</a></h2>
<p>How can we calculate the consumer and producer surplus in the continuous case?</p>
<p>The short answer is: by using <a class="reference external" href="https://en.wikipedia.org/wiki/Integral">integration</a>.</p>
<p>Some readers will already be familiar with the basics of integration.</p>
<p>For those who are not, here is a quick introduction.</p>
<p>In general, for a function <span class="math notranslate nohighlight">\(f\)</span>, the <strong>integral</strong> of <span class="math notranslate nohighlight">\(f\)</span> over the interval <span class="math notranslate nohighlight">\([a, b]\)</span> is the area under the curve <span class="math notranslate nohighlight">\(f\)</span> between <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span>.</p>
<p>This value is written as <span class="math notranslate nohighlight">\(\int_a^b f(x) \mathrm{d} x\)</span> and illustrated in the figure below when <span class="math notranslate nohighlight">\(f(x) = \cos(x/2) + 1\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>

<span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span>
<span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span>
<span class="n">x_grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">ab_grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="mi">400</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_grid</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x_grid</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;$f$&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">ab_grid</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">ab_grid</span><span class="p">),</span> <span class="n">f</span><span class="p">(</span><span class="n">ab_grid</span><span class="p">),</span> 
                <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$\int_a^b f(x) dx$&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<figure class="align-default" id="integrate">
<a class="reference internal image-reference" href="_images/3163fc3306e1b8693f89e661ea810590dac6e16fc5c088ef216d57813c8cdf0d.png"><img alt="_images/3163fc3306e1b8693f89e661ea810590dac6e16fc5c088ef216d57813c8cdf0d.png" src="_images/3163fc3306e1b8693f89e661ea810590dac6e16fc5c088ef216d57813c8cdf0d.png" style="width: 80%;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 7.6 </span><span class="caption-text">Area under the curve</span><a class="headerlink" href="#integrate" title="Link to this image">#</a></p>
</figcaption>
</figure>
</div>
</div>
<p>There are many rules for calculating integrals, with different rules applying to different choices of <span class="math notranslate nohighlight">\(f\)</span>.</p>
<p>Many of these rules relate to one of the most beautiful and powerful results in all of mathematics: the <a class="reference external" href="https://en.wikipedia.org/wiki/Fundamental_theorem_of_calculus">fundamental theorem of calculus</a>.</p>
<p>We will not try to cover these ideas here, partly because the subject is too big, and partly because you only need to know one rule for this lecture, stated below.</p>
<p>If <span class="math notranslate nohighlight">\(f(x) = c + dx\)</span>, then</p>
<div class="math notranslate nohighlight">
\[ 
\int_a^b f(x) \mathrm{d} x = c (b - a) + \frac{d}{2}(b^2 - a^2) 
\]</div>
<p>In fact this rule is so simple that it can be calculated from elementary geometry – you might like to try by graphing <span class="math notranslate nohighlight">\(f\)</span> and calculating the area under the curve between <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span>.</p>
<p>We use this rule repeatedly in what follows.</p>
</section>
<section id="supply-and-demand">
<h2><span class="section-number">7.5. </span>Supply and demand<a class="headerlink" href="#supply-and-demand" title="Link to this heading">#</a></h2>
<p>Let’s now put supply and demand together.</p>
<p>This leads us to the all important notion of market equilibrium, and from there onto a discussion of equilibria and welfare.</p>
<p>For most of this discussion, we’ll assume that inverse demand and supply curves are <strong>affine</strong> functions of quantity.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>“Affine” means “linear plus a constant” and <a class="reference external" href="https://math.stackexchange.com/questions/275310/what-is-the-difference-between-linear-and-affine-function">here</a> is a nice discussion about it.</p>
</div>
<p>We’ll also assume affine inverse supply and demand functions when we study models with multiple consumption goods in our <a class="reference internal" href="supply_demand_multiple_goods.html"><span class="doc">subsequent lecture</span></a>.</p>
<p>We do this in order to simplify the exposition and enable us to use just a few tools from linear algebra, namely, matrix multiplication and matrix inversion.</p>
<p>We study a market for a single good in which buyers and sellers exchange a quantity <span class="math notranslate nohighlight">\(q\)</span> for a price <span class="math notranslate nohighlight">\(p\)</span>.</p>
<p>Quantity <span class="math notranslate nohighlight">\(q\)</span> and price <span class="math notranslate nohighlight">\(p\)</span> are  both scalars.</p>
<p>We assume that inverse demand and supply curves for the good are:</p>
<div class="math notranslate nohighlight">
\[
p = d_0 - d_1 q, \quad d_0, d_1 &gt; 0
\]</div>
<div class="math notranslate nohighlight">
\[
p = s_0 + s_1 q , \quad s_0, s_1 &gt; 0
\]</div>
<p>We call them inverse demand and supply curves because price is on the left side of the equation rather than on the right side as it would be in a direct demand or supply function.</p>
<p>We can use a <a class="reference external" href="https://docs.python.org/3/library/collections.html#collections.namedtuple">namedtuple</a> to store the parameters for our single good market.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Market</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s1">&#39;Market&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;d_0&#39;</span><span class="p">,</span> <span class="c1"># demand intercept</span>
                               <span class="s1">&#39;d_1&#39;</span><span class="p">,</span> <span class="c1"># demand slope</span>
                               <span class="s1">&#39;s_0&#39;</span><span class="p">,</span> <span class="c1"># supply intercept</span>
                               <span class="s1">&#39;s_1&#39;</span><span class="p">]</span> <span class="c1"># supply slope</span>
                   <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The function below creates an instance of a Market namedtuple with default values.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">create_market</span><span class="p">(</span><span class="n">d_0</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">d_1</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">s_0</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">s_1</span><span class="o">=</span><span class="mf">0.4</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">Market</span><span class="p">(</span><span class="n">d_0</span><span class="o">=</span><span class="n">d_0</span><span class="p">,</span> <span class="n">d_1</span><span class="o">=</span><span class="n">d_1</span><span class="p">,</span> <span class="n">s_0</span><span class="o">=</span><span class="n">s_0</span><span class="p">,</span> <span class="n">s_1</span><span class="o">=</span><span class="n">s_1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>This <code class="docutils literal notranslate"><span class="pre">market</span></code> can then be used by our <code class="docutils literal notranslate"><span class="pre">inverse_demand</span></code> and <code class="docutils literal notranslate"><span class="pre">inverse_supply</span></code> functions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">inverse_demand</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">model</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">model</span><span class="o">.</span><span class="n">d_0</span> <span class="o">-</span> <span class="n">model</span><span class="o">.</span><span class="n">d_1</span> <span class="o">*</span> <span class="n">q</span>

<span class="k">def</span><span class="w"> </span><span class="nf">inverse_supply</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">model</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">model</span><span class="o">.</span><span class="n">s_0</span> <span class="o">+</span> <span class="n">model</span><span class="o">.</span><span class="n">s_1</span> <span class="o">*</span> <span class="n">q</span>
</pre></div>
</div>
</div>
</div>
<p>Here is a plot of these two functions using <code class="docutils literal notranslate"><span class="pre">market</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">market</span> <span class="o">=</span> <span class="n">create_market</span><span class="p">()</span>

<span class="n">grid_min</span><span class="p">,</span> <span class="n">grid_max</span><span class="p">,</span> <span class="n">grid_size</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mi">200</span>
<span class="n">q_grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">grid_min</span><span class="p">,</span> <span class="n">grid_max</span><span class="p">,</span> <span class="n">grid_size</span><span class="p">)</span>
<span class="n">supply_curve</span> <span class="o">=</span> <span class="n">inverse_supply</span><span class="p">(</span><span class="n">q_grid</span><span class="p">,</span> <span class="n">market</span><span class="p">)</span>
<span class="n">demand_curve</span> <span class="o">=</span> <span class="n">inverse_demand</span><span class="p">(</span><span class="n">q_grid</span><span class="p">,</span> <span class="n">market</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">q_grid</span><span class="p">,</span> <span class="n">supply_curve</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;supply&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">q_grid</span><span class="p">,</span> <span class="n">demand_curve</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;demand&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper center&#39;</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;quantity&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;price&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<figure class="align-default" id="supply-demand">
<a class="reference internal image-reference" href="_images/1ac00743a004387fb627278939aee0eed7f2cbb043a80d515a211760b0b891ee.png"><img alt="_images/1ac00743a004387fb627278939aee0eed7f2cbb043a80d515a211760b0b891ee.png" src="_images/1ac00743a004387fb627278939aee0eed7f2cbb043a80d515a211760b0b891ee.png" style="width: 80%;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 7.7 </span><span class="caption-text">Supply and demand</span><a class="headerlink" href="#supply-demand" title="Link to this image">#</a></p>
</figcaption>
</figure>
</div>
</div>
<p>In the above graph, an <strong>equilibrium</strong> price-quantity pair occurs at the intersection of the supply and demand curves.</p>
<section id="id2">
<h3><span class="section-number">7.5.1. </span>Consumer surplus<a class="headerlink" href="#id2" title="Link to this heading">#</a></h3>
<p>Let a quantity <span class="math notranslate nohighlight">\(q\)</span> be given and let <span class="math notranslate nohighlight">\(p := d_0 - d_1 q\)</span> be the
corresponding price on the inverse demand curve.</p>
<p>We define <strong>consumer surplus</strong> <span class="math notranslate nohighlight">\(S_c(q)\)</span> as the area under an inverse demand
curve minus <span class="math notranslate nohighlight">\(p q\)</span>:</p>
<div class="math notranslate nohighlight" id="equation-eq-cstm-spls">
<span class="eqno">(7.1)<a class="headerlink" href="#equation-eq-cstm-spls" title="Link to this equation">#</a></span>\[
S_c(q) := 
\int_0^{q} (d_0 - d_1 x) \mathrm{d} x - p q 
\]</div>
<p>The next figure illustrates</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">q</span> <span class="o">=</span> <span class="mf">1.25</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">inverse_demand</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">market</span><span class="p">)</span>
<span class="n">ps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">q_grid</span><span class="p">)</span> <span class="o">*</span> <span class="n">p</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">q_grid</span><span class="p">,</span> <span class="n">demand_curve</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;demand&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">q_grid</span><span class="p">[</span><span class="n">q_grid</span> <span class="o">&lt;=</span> <span class="n">q</span><span class="p">],</span>
                <span class="n">demand_curve</span><span class="p">[</span><span class="n">q_grid</span> <span class="o">&lt;=</span> <span class="n">q</span><span class="p">],</span>
                <span class="n">ps</span><span class="p">[</span><span class="n">q_grid</span> <span class="o">&lt;=</span> <span class="n">q</span><span class="p">],</span>
                <span class="n">label</span><span class="o">=</span><span class="s1">&#39;consumer surplus&#39;</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="s2">&quot;orange&quot;</span><span class="p">,</span> 
                <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper center&#39;</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">((</span><span class="n">q</span><span class="p">,))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">((</span><span class="s2">&quot;$q$&quot;</span><span class="p">,))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">((</span><span class="n">p</span><span class="p">,))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">((</span><span class="s2">&quot;$p$&quot;</span><span class="p">,))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;quantity&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;price&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<figure class="align-default" id="supply-demand-cs">
<a class="reference internal image-reference" href="_images/560d052c49916d7cf8c47da3e08bc091ce6c1983f21c30147c45f2fe4184e5ee.png"><img alt="_images/560d052c49916d7cf8c47da3e08bc091ce6c1983f21c30147c45f2fe4184e5ee.png" src="_images/560d052c49916d7cf8c47da3e08bc091ce6c1983f21c30147c45f2fe4184e5ee.png" style="width: 80%;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 7.8 </span><span class="caption-text">Supply and demand (consumer surplus)</span><a class="headerlink" href="#supply-demand-cs" title="Link to this image">#</a></p>
</figcaption>
</figure>
</div>
</div>
<p>Consumer surplus provides a measure of total consumer welfare at quantity <span class="math notranslate nohighlight">\(q\)</span>.</p>
<p>The idea is that the inverse demand curve <span class="math notranslate nohighlight">\(d_0 - d_1 q\)</span> shows a consumer’s willingness to
pay for an additional increment of the good at a given quantity <span class="math notranslate nohighlight">\(q\)</span>.</p>
<p>The difference between willingness to pay and the actual price is consumer surplus.</p>
<p>The value <span class="math notranslate nohighlight">\(S_c(q)\)</span> is the “sum” (i.e., integral) of these surpluses when the total
quantity purchased is <span class="math notranslate nohighlight">\(q\)</span> and the purchase price is <span class="math notranslate nohighlight">\(p\)</span>.</p>
<p>Evaluating the integral in the definition of consumer surplus <a class="reference internal" href="#equation-eq-cstm-spls">(7.1)</a> gives</p>
<div class="math notranslate nohighlight">
\[
S_c(q) 
= d_0 q - \frac{1}{2} d_1 q^2 - p q
\]</div>
</section>
<section id="id3">
<h3><span class="section-number">7.5.2. </span>Producer surplus<a class="headerlink" href="#id3" title="Link to this heading">#</a></h3>
<p>Let a quantity <span class="math notranslate nohighlight">\(q\)</span> be given and let <span class="math notranslate nohighlight">\(p := s_0 + s_1 q\)</span> be the
corresponding price on the inverse supply curve.</p>
<p>We define <strong>producer surplus</strong> as <span class="math notranslate nohighlight">\(p q\)</span> minus the area under an inverse supply curve</p>
<div class="math notranslate nohighlight" id="equation-eq-pdcr-spls">
<span class="eqno">(7.2)<a class="headerlink" href="#equation-eq-pdcr-spls" title="Link to this equation">#</a></span>\[
S_p(q) 
:= p q - \int_0^q (s_0 + s_1 x) \mathrm{d} x 
\]</div>
<p>The next figure illustrates</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">q</span> <span class="o">=</span> <span class="mf">0.75</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">inverse_supply</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">market</span><span class="p">)</span>
<span class="n">ps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">q_grid</span><span class="p">)</span> <span class="o">*</span> <span class="n">p</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">q_grid</span><span class="p">,</span> <span class="n">supply_curve</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;supply&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">q_grid</span><span class="p">[</span><span class="n">q_grid</span> <span class="o">&lt;=</span> <span class="n">q</span><span class="p">],</span>
                <span class="n">supply_curve</span><span class="p">[</span><span class="n">q_grid</span> <span class="o">&lt;=</span> <span class="n">q</span><span class="p">],</span>
                <span class="n">ps</span><span class="p">[</span><span class="n">q_grid</span> <span class="o">&lt;=</span> <span class="n">q</span><span class="p">],</span>
                <span class="n">label</span><span class="o">=</span><span class="s1">&#39;producer surplus&#39;</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">,</span>
                <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper center&#39;</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">((</span><span class="n">q</span><span class="p">,))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">((</span><span class="s2">&quot;$q$&quot;</span><span class="p">,))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">((</span><span class="n">p</span><span class="p">,))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">((</span><span class="s2">&quot;$p$&quot;</span><span class="p">,))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;quantity&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;price&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<figure class="align-default" id="supply-demand-ps">
<a class="reference internal image-reference" href="_images/3a31fb44ef99e5f8fe3c48ae56c3f3bb7ddb0c971037806b101528ca748d7c45.png"><img alt="_images/3a31fb44ef99e5f8fe3c48ae56c3f3bb7ddb0c971037806b101528ca748d7c45.png" src="_images/3a31fb44ef99e5f8fe3c48ae56c3f3bb7ddb0c971037806b101528ca748d7c45.png" style="width: 80%;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 7.9 </span><span class="caption-text">Supply and demand (producer surplus)</span><a class="headerlink" href="#supply-demand-ps" title="Link to this image">#</a></p>
</figcaption>
</figure>
</div>
</div>
<p>Producer surplus measures total producer welfare at quantity <span class="math notranslate nohighlight">\(q\)</span></p>
<p>The idea is similar to that of consumer surplus.</p>
<p>The inverse supply curve <span class="math notranslate nohighlight">\(s_0 + s_1 q\)</span> shows the price at which producers are
prepared to sell, given quantity <span class="math notranslate nohighlight">\(q\)</span>.</p>
<p>The difference between willingness to sell and the actual price is producer surplus.</p>
<p>The value <span class="math notranslate nohighlight">\(S_p(q)\)</span> is the integral of these surpluses.</p>
<p>Evaluating the integral in the definition of producer surplus <a class="reference internal" href="#equation-eq-pdcr-spls">(7.2)</a> gives</p>
<div class="math notranslate nohighlight">
\[
S_p(q) = pq - s_0 q -  \frac{1}{2} s_1 q^2
\]</div>
</section>
<section id="social-welfare">
<h3><span class="section-number">7.5.3. </span>Social welfare<a class="headerlink" href="#social-welfare" title="Link to this heading">#</a></h3>
<p>Sometimes economists measure social welfare by a <strong>welfare criterion</strong> that
equals consumer surplus plus producer surplus, assuming that consumers and
producers pay the same price:</p>
<div class="math notranslate nohighlight">
\[
W(q)
= \int_0^q (d_0 - d_1 x) dx - \int_0^q (s_0 + s_1 x) \mathrm{d} x  
\]</div>
<p>Evaluating the integrals gives</p>
<div class="math notranslate nohighlight">
\[
W(q) = (d_0 - s_0) q -  \frac{1}{2} (d_1 + s_1) q^2
\]</div>
<p>Here is a Python function that evaluates this social welfare at a given
quantity <span class="math notranslate nohighlight">\(q\)</span> and a fixed set of parameters.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">W</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">market</span><span class="p">):</span>
    <span class="c1"># Compute and return welfare</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">market</span><span class="o">.</span><span class="n">d_0</span> <span class="o">-</span> <span class="n">market</span><span class="o">.</span><span class="n">s_0</span><span class="p">)</span> <span class="o">*</span> <span class="n">q</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">market</span><span class="o">.</span><span class="n">d_1</span> <span class="o">+</span> <span class="n">market</span><span class="o">.</span><span class="n">s_1</span><span class="p">)</span> <span class="o">*</span> <span class="n">q</span><span class="o">**</span><span class="mi">2</span>
</pre></div>
</div>
</div>
</div>
<p>The next figure plots welfare as a function of <span class="math notranslate nohighlight">\(q\)</span>.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">q_vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.78</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">q_vals</span><span class="p">,</span> <span class="n">W</span><span class="p">(</span><span class="n">q_vals</span><span class="p">,</span> <span class="n">market</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;welfare&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;brown&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;quantity&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<figure class="align-default" id="wf">
<a class="reference internal image-reference" href="_images/5b840d2e160cbd9da1b6d615d9b6c52705ed3f077418d1957c3d3613622c6c25.png"><img alt="_images/5b840d2e160cbd9da1b6d615d9b6c52705ed3f077418d1957c3d3613622c6c25.png" src="_images/5b840d2e160cbd9da1b6d615d9b6c52705ed3f077418d1957c3d3613622c6c25.png" style="width: 80%;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 7.10 </span><span class="caption-text">Welfare</span><a class="headerlink" href="#wf" title="Link to this image">#</a></p>
</figcaption>
</figure>
</div>
</div>
<p>Let’s now give a social planner the task of maximizing social welfare.</p>
<p>To compute a quantity that  maximizes the welfare criterion, we differentiate
<span class="math notranslate nohighlight">\(W\)</span> with respect to <span class="math notranslate nohighlight">\(q\)</span> and then set the derivative to zero.</p>
<div class="math notranslate nohighlight">
\[
\frac{\mathrm{d} W(q)}{\mathrm{d} q} = d_0 - s_0 - (d_1 + s_1) q  = 0
\]</div>
<p>Solving for <span class="math notranslate nohighlight">\(q\)</span> yields</p>
<div class="math notranslate nohighlight" id="equation-eq-old1">
<span class="eqno">(7.3)<a class="headerlink" href="#equation-eq-old1" title="Link to this equation">#</a></span>\[
q = \frac{ d_0 - s_0}{s_1 + d_1}
\]</div>
<p>Let’s remember the quantity <span class="math notranslate nohighlight">\(q\)</span> given by equation <a class="reference internal" href="#equation-eq-old1">(7.3)</a> that a social planner would choose to maximize consumer surplus plus producer surplus.</p>
<p>We’ll compare it to the quantity that emerges in a competitive equilibrium that equates supply to demand.</p>
</section>
<section id="competitive-equilibrium">
<h3><span class="section-number">7.5.4. </span>Competitive equilibrium<a class="headerlink" href="#competitive-equilibrium" title="Link to this heading">#</a></h3>
<p>Instead of equating quantities supplied and demanded, we can accomplish the
same thing by equating demand price to supply price:</p>
<div class="math notranslate nohighlight">
\[
p =  d_0 - d_1 q = s_0 + s_1 q 
\]</div>
<p>If we solve the equation defined by the second equality in the above line for
<span class="math notranslate nohighlight">\(q\)</span>, we obtain</p>
<div class="math notranslate nohighlight" id="equation-eq-equilib-q">
<span class="eqno">(7.4)<a class="headerlink" href="#equation-eq-equilib-q" title="Link to this equation">#</a></span>\[
q = \frac{ d_0 - s_0}{s_1 + d_1}
\]</div>
<p>This is the competitive equilibrium quantity.</p>
<p>Observe that the equilibrium quantity equals the same <span class="math notranslate nohighlight">\(q\)</span> given by equation  <a class="reference internal" href="#equation-eq-old1">(7.3)</a>.</p>
<p>The outcome that the quantity determined by equation <a class="reference internal" href="#equation-eq-old1">(7.3)</a> equates
supply to demand brings us a <em>key finding</em>:</p>
<ul class="simple">
<li><p>a competitive equilibrium quantity maximizes our welfare criterion</p></li>
</ul>
<p>This is a version of the <a class="reference external" href="https://en.wikipedia.org/wiki/Fundamental_theorems_of_welfare_economics">first fundamental welfare theorem</a>,</p>
<p>It also brings a useful <strong>competitive equilibrium computation strategy:</strong></p>
<ul class="simple">
<li><p>after solving the welfare problem for an optimal quantity, we can read a competitive equilibrium price from either supply price or demand price at the competitive equilibrium quantity</p></li>
</ul>
</section>
</section>
<section id="generalizations">
<h2><span class="section-number">7.6. </span>Generalizations<a class="headerlink" href="#generalizations" title="Link to this heading">#</a></h2>
<p>In a <a class="reference internal" href="supply_demand_multiple_goods.html"><span class="doc">later lecture</span></a>, we’ll derive
generalizations of the above demand and supply curves from other objects.</p>
<p>Our generalizations will extend the preceding analysis of a market for a single good to the analysis of <span class="math notranslate nohighlight">\(n\)</span> simultaneous markets in <span class="math notranslate nohighlight">\(n\)</span> goods.</p>
<p>In addition</p>
<ul class="simple">
<li><p>we’ll derive  <em>demand curves</em> from a consumer problem that maximizes a
<em>utility function</em> subject to a <em>budget constraint</em>.</p></li>
<li><p>we’ll derive  <em>supply curves</em> from the problem of a producer who is price
taker and maximizes his profits minus total costs that are described by a <em>cost function</em>.</p></li>
</ul>
</section>
<section id="exercises">
<h2><span class="section-number">7.7. </span>Exercises<a class="headerlink" href="#exercises" title="Link to this heading">#</a></h2>
<p>Suppose now that the inverse demand and supply curves are modified to take the
form</p>
<div class="math notranslate nohighlight">
\[
p = i_d(q) := d_0 - d_1 q^{0.6} 
\]</div>
<div class="math notranslate nohighlight">
\[
p = i_s(q) := s_0 + s_1 q^{1.8} 
\]</div>
<p>All parameters are positive, as before.</p>
<div class="exercise admonition" id="isd_ex1">

<p class="admonition-title"><span class="caption-number">Exercise 7.1 </span></p>
<section id="exercise-content">
<p>Use the same <code class="docutils literal notranslate"><span class="pre">Market</span></code> namedtuple that holds the parameter values as before but
make new <code class="docutils literal notranslate"><span class="pre">inverse_demand</span></code> and <code class="docutils literal notranslate"><span class="pre">inverse_supply</span></code> functions to match these new definitions.</p>
<p>Then plot the inverse demand and supply curves <span class="math notranslate nohighlight">\(i_d\)</span> and <span class="math notranslate nohighlight">\(i_s\)</span>.</p>
</section>
</div>
<div class="solution dropdown admonition" id="intro_supply_demand-solution-3">

<p class="admonition-title">Solution to<a class="reference internal" href="#isd_ex1"> Exercise 7.1</a></p>
<section id="solution-content">
<p>Let’s update the <code class="docutils literal notranslate"><span class="pre">inverse_demand</span></code> and <code class="docutils literal notranslate"><span class="pre">inverse_supply</span></code> functions, as defined above.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">inverse_demand</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">model</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">model</span><span class="o">.</span><span class="n">d_0</span> <span class="o">-</span> <span class="n">model</span><span class="o">.</span><span class="n">d_1</span> <span class="o">*</span> <span class="n">q</span><span class="o">**</span><span class="mf">0.6</span>

<span class="k">def</span><span class="w"> </span><span class="nf">inverse_supply</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">model</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">model</span><span class="o">.</span><span class="n">s_0</span> <span class="o">+</span> <span class="n">model</span><span class="o">.</span><span class="n">s_1</span> <span class="o">*</span> <span class="n">q</span><span class="o">**</span><span class="mf">1.8</span>
</pre></div>
</div>
</div>
</div>
<p>Here is a plot of inverse supply and demand.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grid_min</span><span class="p">,</span> <span class="n">grid_max</span><span class="p">,</span> <span class="n">grid_size</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mi">200</span>
<span class="n">q_grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">grid_min</span><span class="p">,</span> <span class="n">grid_max</span><span class="p">,</span> <span class="n">grid_size</span><span class="p">)</span>
<span class="n">market</span> <span class="o">=</span> <span class="n">create_market</span><span class="p">()</span>
<span class="n">supply_curve</span> <span class="o">=</span> <span class="n">inverse_supply</span><span class="p">(</span><span class="n">q_grid</span><span class="p">,</span> <span class="n">market</span><span class="p">)</span>
<span class="n">demand_curve</span> <span class="o">=</span> <span class="n">inverse_demand</span><span class="p">(</span><span class="n">q_grid</span><span class="p">,</span> <span class="n">market</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">q_grid</span><span class="p">,</span> <span class="n">supply_curve</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;supply&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">q_grid</span><span class="p">,</span> <span class="n">demand_curve</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;demand&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper center&#39;</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;quantity&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;price&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/7f789ea9a25cf58d8b6b9aaf853ac852dabe7881b4abbc0f1368f918659f506e.png"><img alt="_images/7f789ea9a25cf58d8b6b9aaf853ac852dabe7881b4abbc0f1368f918659f506e.png" src="_images/7f789ea9a25cf58d8b6b9aaf853ac852dabe7881b4abbc0f1368f918659f506e.png" style="width: 80%;" />
</a>
</div>
</div>
</section>
</div>
<div class="exercise admonition" id="isd_ex2">

<p class="admonition-title"><span class="caption-number">Exercise 7.2 </span></p>
<section id="exercise-content">
<p>As before, consumer surplus at <span class="math notranslate nohighlight">\(q\)</span> is the area under the demand curve minus
price times quantity:</p>
<div class="math notranslate nohighlight">
\[
S_c(q) = \int_0^{q} i_d(x) dx - p q 
\]</div>
<p>Here <span class="math notranslate nohighlight">\(p\)</span> is set to <span class="math notranslate nohighlight">\(i_d(q)\)</span></p>
<p>Producer surplus is price times quantity minus the area under the inverse
supply curve:</p>
<div class="math notranslate nohighlight">
\[
S_p(q) 
= p q - \int_0^q i_s(x) \mathrm{d} x 
\]</div>
<p>Here <span class="math notranslate nohighlight">\(p\)</span> is set to <span class="math notranslate nohighlight">\(i_s(q)\)</span>.</p>
<p>Social welfare is the sum of consumer and producer surplus under the
assumption that the price is the same for buyers and sellers:</p>
<div class="math notranslate nohighlight">
\[
W(q)
= \int_0^q i_d(x) dx - \int_0^q i_s(x) \mathrm{d} x  
\]</div>
<p>Solve the integrals and write a function to compute this quantity numerically
at given <span class="math notranslate nohighlight">\(q\)</span>.</p>
<p>Plot welfare as a function of <span class="math notranslate nohighlight">\(q\)</span>.</p>
</section>
</div>
<div class="solution dropdown admonition" id="intro_supply_demand-solution-5">

<p class="admonition-title">Solution to<a class="reference internal" href="#isd_ex2"> Exercise 7.2</a></p>
<section id="solution-content">
<p>Solving the integrals gives</p>
<div class="math notranslate nohighlight">
\[
W(q) 
= d_0 q - \frac{d_1 q^{1.6}}{1.6}
    - \left( s_0 q + \frac{s_1 q^{2.8}}{2.8} \right)
\]</div>
<p>Here’s a Python function that computes this value:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">W</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">market</span><span class="p">):</span>
    <span class="c1"># Compute and return welfare</span>
    <span class="n">S_c</span> <span class="o">=</span> <span class="n">market</span><span class="o">.</span><span class="n">d_0</span> <span class="o">*</span> <span class="n">q</span> <span class="o">-</span> <span class="n">market</span><span class="o">.</span><span class="n">d_1</span> <span class="o">*</span> <span class="n">q</span><span class="o">**</span><span class="mf">1.6</span> <span class="o">/</span> <span class="mf">1.6</span>
    <span class="n">S_p</span> <span class="o">=</span> <span class="n">market</span><span class="o">.</span><span class="n">s_0</span> <span class="o">*</span> <span class="n">q</span> <span class="o">+</span> <span class="n">market</span><span class="o">.</span><span class="n">s_1</span> <span class="o">*</span> <span class="n">q</span><span class="o">**</span><span class="mf">2.8</span> <span class="o">/</span> <span class="mf">2.8</span>
    <span class="k">return</span> <span class="n">S_c</span> <span class="o">-</span> <span class="n">S_p</span>
</pre></div>
</div>
</div>
</div>
<p>The next figure plots welfare as a function of <span class="math notranslate nohighlight">\(q\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">q_vals</span><span class="p">,</span> <span class="n">W</span><span class="p">(</span><span class="n">q_vals</span><span class="p">,</span> <span class="n">market</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;welfare&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;brown&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;quantity&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/d5a437f173e8e01ed350aa6e4b39b8d779984a63cb6461aa059fb49e9cdebd21.png"><img alt="_images/d5a437f173e8e01ed350aa6e4b39b8d779984a63cb6461aa059fb49e9cdebd21.png" src="_images/d5a437f173e8e01ed350aa6e4b39b8d779984a63cb6461aa059fb49e9cdebd21.png" style="width: 80%;" />
</a>
</div>
</div>
</section>
</div>
<div class="exercise admonition" id="isd_ex3">

<p class="admonition-title"><span class="caption-number">Exercise 7.3 </span></p>
<section id="exercise-content">
<p>Due to non-linearities, the new welfare function is not easy to maximize with
pencil and paper.</p>
<p>Maximize it using <code class="docutils literal notranslate"><span class="pre">scipy.optimize.minimize_scalar</span></code> instead.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>Our <a class="reference external" href="https://python-programming.quantecon.org/scipy.html">SciPy</a> lecture has
a section on <a class="reference external" href="https://python-programming.quantecon.org/scipy.html#optimization">Optimization</a>
is a useful resource to find out more.</p>
</div>
</section>
</div>
<div class="solution dropdown admonition" id="intro_supply_demand-solution-7">

<p class="admonition-title">Solution to<a class="reference internal" href="#isd_ex3"> Exercise 7.3</a></p>
<section id="solution-content">
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.optimize</span><span class="w"> </span><span class="kn">import</span> <span class="n">minimize_scalar</span>

<span class="k">def</span><span class="w"> </span><span class="nf">objective</span><span class="p">(</span><span class="n">q</span><span class="p">):</span>
    <span class="k">return</span> <span class="o">-</span><span class="n">W</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">market</span><span class="p">)</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">minimize_scalar</span><span class="p">(</span><span class="n">objective</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">message</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Solution found.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">maximizing_q</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">x</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">maximizing_q</span><span class="si">:</span><span class="s2"> .5f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 0.90564
</pre></div>
</div>
</div>
</div>
</section>
</div>
<div class="exercise admonition" id="isd_ex4">

<p class="admonition-title"><span class="caption-number">Exercise 7.4 </span></p>
<section id="exercise-content">
<p>Now compute the equilibrium quantity by finding the price that equates supply
and demand.</p>
<p>You can do this numerically by finding the root of the excess demand function</p>
<div class="math notranslate nohighlight">
\[
e_d(q) := i_d(q) - i_s(q) 
\]</div>
<p>You can use <code class="docutils literal notranslate"><span class="pre">scipy.optimize.newton</span></code> to compute the root.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>Our <a class="reference external" href="https://python-programming.quantecon.org/scipy.html">SciPy</a> lecture has
a section on <a class="reference external" href="https://python-programming.quantecon.org/scipy.html#roots-and-fixed-points">Roots and Fixed Points</a>
is a useful resource to find out more.</p>
</div>
<p>Initialize <code class="docutils literal notranslate"><span class="pre">newton</span></code> with a starting guess somewhere close to 1.0.</p>
<p>(Similar initial conditions will give the same result.)</p>
<p>You should find that the equilibrium price agrees with the welfare maximizing
price, in line with the first fundamental welfare theorem.</p>
</section>
</div>
<div class="solution dropdown admonition" id="intro_supply_demand-solution-9">

<p class="admonition-title">Solution to<a class="reference internal" href="#isd_ex4"> Exercise 7.4</a></p>
<section id="solution-content">
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.optimize</span><span class="w"> </span><span class="kn">import</span> <span class="n">newton</span>

<span class="k">def</span><span class="w"> </span><span class="nf">excess_demand</span><span class="p">(</span><span class="n">q</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">inverse_demand</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">market</span><span class="p">)</span> <span class="o">-</span> <span class="n">inverse_supply</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">market</span><span class="p">)</span>

<span class="n">equilibrium_q</span> <span class="o">=</span> <span class="n">newton</span><span class="p">(</span><span class="n">excess_demand</span><span class="p">,</span> <span class="mf">0.99</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">equilibrium_q</span><span class="si">:</span><span class="s2"> .5f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 0.90564
</pre></div>
</div>
</div>
</div>
</section>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                    </div>
                    
                </main> <!-- .page__content -->
                


                <footer class="qe-page__footer">

                    <p><a href="https://creativecommons.org/licenses/by-sa/4.0/"><img src="https://licensebuttons.net/l/by-sa/4.0/80x15.png"></a></p>

                    <p>Creative Commons License &ndash; This work is licensed under a Creative Commons Attribution-ShareAlike 4.0 International.</p>

                    <p>A theme by <a href="https://quantecon.org">QuantEcon</a></p>

                </footer> <!-- .page__footer -->

            </div> <!-- .page -->

            

            
            <div class="qe-sidebar bd-sidebar inactive" id="site-navigation">

                <div class="qe-sidebar__header">


                    Contents

                </div>

                <nav class="qe-sidebar__nav" id="qe-sidebar-nav" aria-label="Main navigation">
                    <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Introduction
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="about.html">
   1. About These Lectures
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Economic Data
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="long_run_growth.html">
   2. Long-Run Growth
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="business_cycle.html">
   3. Business Cycles
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="inflation_history.html">
   4. Price Level Histories
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="french_rev.html">
   5. Inflation During French Revolution
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="inequality.html">
   6. Income and Wealth Inequality
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Foundations
 </span>
</p>
<ul class="current nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1 current active active">
  <a class="current reference internal" href="#">
   7. Introduction to Supply and Demand
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="linear_equations.html">
   8. Linear Equations and Matrix Algebra
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="complex_and_trig.html">
   9. Complex Numbers and Trigonometry
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="geom_series.html">
   10. Geometric Series for Elementary Economics
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Linear Dynamics: Finite Horizons
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="pv.html">
   11. Present Values
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="cons_smooth.html">
   12. Consumption Smoothing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="tax_smooth.html">
   13. Tax Smoothing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="equalizing_difference.html">
   14. Equalizing Difference Model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="cagan_ree.html">
   15. A Monetarist Theory of Price Levels
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="cagan_adaptive.html">
   16. Monetarist Theory of Price Levels with Adaptive Expectations
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Linear Dynamics: Infinite Horizons
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="eigen_I.html">
   17. Eigenvalues and Eigenvectors
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="greek_square.html">
   18. Computing Square Roots
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Probability and Distributions
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="prob_dist.html">
   19. Distributions and Probabilities
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lln_clt.html">
   20. LLN and CLT
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="monte_carlo.html">
   21. Monte Carlo and Option Pricing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="heavy_tails.html">
   22. Heavy-Tailed Distributions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="schelling.html">
   23. Racial Segregation
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Nonlinear Dynamics
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="scalar_dynam.html">
   24. Dynamics in One Dimension
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="solow.html">
   25. The Solow-Swan Growth Model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="cobweb.html">
   26. The Cobweb Model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="olg.html">
   27. The Overlapping Generations Model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="commod_price.html">
   28. Commodity Prices
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Monetary-Fiscal Policy Interactions
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="money_inflation.html">
   29. Money Financed Government Deficits and Price Levels
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="unpleasant.html">
   30. Some Unpleasant Monetarist Arithmetic
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="money_inflation_nonlinear.html">
   31. Inflation Rate Laffer Curves
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="laffer_adaptive.html">
   32. Laffer Curves  with Adaptive Expectations
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Stochastic Dynamics
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="ar1_processes.html">
   33. AR(1) Processes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="markov_chains_I.html">
   34. Markov Chains: Basic Concepts
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="markov_chains_II.html">
   35. Markov Chains: Irreducibility and Ergodicity
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="time_series_with_matrices.html">
   36. Univariate Time Series with Matrix Algebra
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Optimization
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="lp_intro.html">
   37. Linear Programming
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="short_path.html">
   38. Shortest Paths
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Modeling in Higher Dimensions
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="eigen_II.html">
   39. The Perron-Frobenius Theorem
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="input_output.html">
   40. Input-Output Models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lake_model.html">
   41. A Lake Model of Employment
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="networks.html">
   42. Networks
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Markets and Competitive Equilibrium
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="supply_demand_multiple_goods.html">
   43. Supply and Demand with Many Goods
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="supply_demand_heterogeneity.html">
   44. Market Equilibrium with Heterogeneity
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Estimation
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="simple_linear_regression.html">
   45. Simple Linear Regression Model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mle.html">
   46. Maximum Likelihood Estimation
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Other
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="troubleshooting.html">
   47. Troubleshooting
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="zreferences.html">
   48. References
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="status.html">
   49. Execution Statistics
  </a>
 </li>
</ul>

                </nav>

                <div class="qe-sidebar__footer">

                </div>

            </div> <!-- .sidebar -->
            
        </div> <!-- .main -->

        <div class="qe-toolbar">

            <div class="qe-toolbar__inner">

                <ul class="qe-toolbar__main">
                    <li data-tippy-content="Table of Contents" class="btn__sidebar"><i data-feather="menu"></i></li>
                    <li data-tippy-content="Home"><a href="intro.html"><i data-feather="home"></i></a></li>
                    <li class="btn__qelogo"><a href="https://quantecon.org" title=""><span class="show-for-sr">QuantEcon</span></a></li>
                </ul>

                <ul class="qe-toolbar__links">
                    <li class="btn__search">
                        <form action="search.html" method="get">
                            <input type="search" class="form-control" name="q" id="search-input" placeholder="Search..." aria-label="Search..." autocomplete="off" accesskey="k">
                            <i data-feather="search" id="search-icon"></i>
                        </form>
                    </li>
                    <li data-tippy-content="Fullscreen" class="btn__fullscreen"><i data-feather="maximize"></i></li>
                    <li data-tippy-content="Increase font size" class="btn__plus"><i data-feather="plus-circle"></i></li>
                    <li data-tippy-content="Decrease font size" class="btn__minus"><i data-feather="minus-circle"></i></li>
                    <li data-tippy-content="Change contrast" class="btn__contrast"><i data-feather="sunset"></i></li>
                    <li data-tippy-content="Download Notebook"><a href="/_notebooks/intro_supply_demand.ipynb" download><i data-feather="download-cloud"></i></a></li>
                    <li class="settings-button" id="settingsButton"><div data-tippy-content="Launch Notebook"><i data-feather="play-circle"></i></div></li>
                        <li class="download-pdf" id="downloadButton"><i data-feather="file"></i></li>
                    <!--
                    # Enable if looking for link to specific document hosted on GitHub
                    <li data-tippy-content="View Source"><a target="_blank" href="https://github.com/QuantEcon/lecture-python-intro/blob/main/lectures/intro_supply_demand.md" download><i data-feather="github"></i></a></li>
                    -->
                    <li data-tippy-content="View Source"><a target="_blank" href="https://github.com/QuantEcon/lecture-python-intro" download><i data-feather="github"></i></a></li>
                </ul>

            </div>

        </div> <!-- .toolbar -->
        <div id="downloadPDFModal" style="display: none;">
            <ul class="pdf-options" style="display: block;">
                <li class="download-pdf-book" onClick="window.print()">
                    <p>Lecture (PDF)</p>
                </li>
                <li class="download-pdf-file">
                    <a href="/_pdf/quantecon-python-intro.pdf" download><p>Book (PDF)</p></a>
                </li>
            </ul>
        </div>
        <div id="settingsModal" style="display: none;">
            <p class="modal-title"> Notebook Launcher </p>
            <div class="modal-desc">
            <p>
                Choose public or private cloud service for "Launch" button.
            </p>
            </div>
            <p class="modal-subtitle">Select a server</p>
            <ul class="modal-servers">
            <li class="active launcher-public">
                <span class="label">Public</span>
                <select id="launcher-public-input">
                
                    <option value="https://colab.research.google.com/github/QuantEcon/lecture-python-intro.notebooks/blob/main/intro_supply_demand.ipynb">Colab</option>
                
                </select>
                <i class="fas fa-check-circle"></i>
            </li>
            <li class="launcher-private">
                <span class="label">Private</span>
                <input type="text" id="launcher-private-input" data-repourl="https://github.com/QuantEcon/lecture-python-intro.notebooks" data-urlpath="tree/lecture-python-intro.notebooks/intro_supply_demand.ipynb" data-branch=main>
                <i class="fas fa-check-circle"></i>
            </li>
            </ul>
            <p class="launch"><a href="https://colab.research.google.com/github/QuantEcon/lecture-python-intro.notebooks/blob/main/intro_supply_demand.ipynb" id="advancedLaunchButton" target="_blank">Launch Notebook</a></p>
            <script>
                // QuantEcon Notebook Launcher
                const launcherTypeElements = document.querySelectorAll('#settingsModal .modal-servers li');
                // Highlight the server type if previous selection exists
                if (typeof localStorage.launcherType !== 'undefined') {
                  for (var i = 0; i < launcherTypeElements.length; i++) {
                    launcherTypeElements[i].classList.remove('active');
                    if ( launcherTypeElements[i].classList.contains(localStorage.launcherType) ) {
                      launcherTypeElements[i].classList.add('active');
                    }
                  }
                }
                // Highlight server type on click and set local storage value
                for (var i = 0; i < launcherTypeElements.length; i++) {
                  launcherTypeElements[i].addEventListener('click', function() {
                    for (var j = 0; j < launcherTypeElements.length; j++) {
                      launcherTypeElements[j].classList.remove('active');
                    }
                    this.classList.add('active');
                    if ( this.classList.contains('launcher-private') ) {
                      localStorage.launcherType = 'launcher-private';
                    } else if ( this.classList.contains('launcher-public') ) {
                      localStorage.launcherType = 'launcher-public';
                    }
                    setLaunchServer();
                  })
                }
                const launcherPublic = document.getElementById('launcher-public-input');
                const launcherPrivate = document.getElementById('launcher-private-input');
                const pageName = "intro_supply_demand";
                const repoURL = "https://github.com/QuantEcon/lecture-python-intro.notebooks";
                const urlPath = "tree/lecture-python-intro.notebooks/intro_supply_demand.ipynb";
                const branch = "main"
                const launchNotebookLink = document.getElementById('advancedLaunchButton');

                // Highlight public server option if previous selection exists
                if (typeof localStorage.launcherPublic !== 'undefined') {
                  launcherPublic.value = localStorage.launcherPublic;
                }
                // Update local storage upon public server selection
                launcherPublic.addEventListener('change', (event) => {
                  setLaunchServer();
                });
                // Populate private server input if previous entry exists
                if (typeof localStorage.launcherPrivate !== 'undefined') {
                  launcherPrivate.value = localStorage.launcherPrivate;
                }
                // Update local storage when a private server is entered
                launcherPrivate.addEventListener('input', (event) => {
                  setLaunchServer();
                });

                // Function to update the "Launch Notebook" link href
                function setLaunchServer() {
                  launchNotebookLink.removeAttribute("style")
                  if ( localStorage.launcherType == 'launcher-private' ) {
                    let repoPrefix = "/user-redirect/git-pull?repo=" + repoURL + "&branch=" + branch + "&urlpath=" + urlPath;
                    launcherPrivateValue = launcherPrivate.value
                    if (!launcherPrivateValue) {
                        launchNotebookLink.removeAttribute("href")
                        launchNotebookLink.style.background = "grey"
                        return
                    }
                    localStorage.launcherPrivate = launcherPrivateValue;
                    privateServer = localStorage.launcherPrivate.replace(/\/$/, "")
                    if (!privateServer.includes("http")) {
                        privateServer = "http://" + privateServer
                    }
                    launchNotebookLinkURL = privateServer + repoPrefix;
                  } else if ( localStorage.launcherType == 'launcher-public' ) {
                    launcherPublicValue = launcherPublic.options[launcherPublic.selectedIndex].value;
                    localStorage.launcherPublic = launcherPublicValue;
                    launchNotebookLinkURL = localStorage.launcherPublic;
                  }
                  if (launchNotebookLinkURL) launchNotebookLink.href = launchNotebookLinkURL;
                }
                // Check if user has previously selected a server
                if ( (typeof localStorage.launcherPrivate !== 'undefined') || (typeof localStorage.launcherPublic !== 'undefined') ) {
                  setLaunchServer();
                }
                </script>

        </div>

    </div> <!-- .wrapper-->
  </body>
</html>